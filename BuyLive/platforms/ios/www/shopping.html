<!DOCTYPE HTML>
<html>
 <head>
   <title>Buy Live</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   
 	<!--  <script src="js/cordova.js"></script> -->
   <script src="js/jquery-1.9.1.min.js"></script>
   <script src="js/jquery.mobile-1.3.2.js"></script>
   <script src="cordova.js"></script>
   <script src="js/app.js" type="text/javascript"></script>
    <script src="js/function.js"></script>
	 <script src="js/dbsql.js" type="text/javascript"></script>
	<script type="text/javascript" charset="utf-8" src="js/HelloPlugin.js"></script>
    
    
    
   
	<script type="text/javascript">
	

	var path;
	var path_arr;
        var filePath = "";
	document.addEventListener("deviceready", onDeviceReady, false);
	function onDeviceReady()
   {
			initDatabase();
			change_quantity();
			window.requestFileSystem  = window.requestFileSystem || window.webkitRequestFileSystem;
			window.requestFileSystem(LocalFileSystem.TEMPORARY, 0, gotFS, fail);
			$(window).bind('resize', function () {
			 
			 
			   var divWidth = $('#outer').width();
			   var useDivWidth= divWidth-80;
			   var radioButtonWidth=0.25*useDivWidth;
			   var searchBar=0.5*useDivWidth;


			   	
			   
				var divWidthq = $('#outdiv').width();
			   var useDivWidthq= divWidthq-53;
			  
			   var searchBarq=0.5*useDivWidthq;	
			   
			   
			     $('#radioCat').css({'width':radioButtonWidth});
			     $('#radioName').css({'width':radioButtonWidth});
			     $('#searchBar').css({'width':searchBar});
					
			
			   
			   

			}).trigger('resize');
			
			
			

 


		}
		
		
		function fail() 
	{
		
        
	}
	
	function gotFS(fileSystem) {




    

    // save the file system for later access

    

    window.rootFS = fileSystem.root;

    path  = fileSystem.root.fullPath;

    filePath = rootFS.toURL()+"/"+app_folder;

    store_crousel_scroll();

    if( device.platform == "Android")

    {

		path_arr  = path.split('///');

	    path_arr ='/'+path_arr[1];




    }

    if( device.platform == "iOS")

    {

        path_arr = path.split('/');

        var path_len = path_arr.length;

        

        path_arr[path_len - 1] = 'Library/Caches';

        path_arr = path_arr.join('/');

    }

}


	</script>
	


   <link rel="stylesheet" type="text/css" href="css/jquery.mobile.flatui.css" />

   <style>
   .clr{
		clear: both;
		margin:0;
		padding:0;
		float:none;
	}
	
	.ui-page .ui-content .ui-btn.my-btn .ui-btn-inner {
    color      : green;
    background : red;
}

.borderclass
{
	border:5px solid red;
	
}
	</style>
	<style type="text/css">
      .storeAddPopUpList
	{
	float:left;width:80%;padding-left:5px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;margin-top:-3px;position: relative;left: 5px;
	}

	

	@media all and (max-width: 100000px) and (min-width:436px){

	  .storeAddPopUpList{
	float:left;width:80%;padding-left:5px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;margin-top:-3px;position: relative;left: 5px;
	}
	}

        .demo {
            display: none;
        }
    </style>

    <script src="js/mobiscroll.core.js"></script>
    <script src="js/mobiscroll.scroller.js" type="text/javascript"></script>

    <script src="js/mobiscroll.datetime.js" type="text/javascript"></script>
    <script src="js/mobiscroll.select.js" type="text/javascript"></script>

    <script src="js/mobiscroll.scroller.jqm.js" type="text/javascript"></script>
    <script src="js/mobiscroll.scroller.ios.js" type="text/javascript"></script>
    <script src="js/mobiscroll.scroller.android.js" type="text/javascript"></script>
    <script src="js/mobiscroll.scroller.android-ics.js" type="text/javascript"></script>
    <script src="js/mobiscroll.scroller.wp.js" type="text/javascript"></script>

    <script src="js/i18n/mobiscroll.i18n.de.js" type="text/javascript"></script>
    <script src="js/i18n/mobiscroll.i18n.es.js" type="text/javascript"></script>
    <script src="js/i18n/mobiscroll.i18n.fr.js" type="text/javascript"></script>
    <script src="js/i18n/mobiscroll.i18n.hu.js" type="text/javascript"></script>
    <script src="js/i18n/mobiscroll.i18n.it.js" type="text/javascript"></script>
    <script src="js/i18n/mobiscroll.i18n.no.js" type="text/javascript"></script>
    <script src="js/i18n/mobiscroll.i18n.pt-BR.js" type="text/javascript"></script>
    <script src="js/i18n/mobiscroll.i18n.zh.js" type="text/javascript"></script>
	<script src="js/owl.carousel.js" type="text/javascript"></script>

	
    <link href="css/mobiscroll.scroller.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.scroller.jqm.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.scroller.android.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.scroller.android-ics.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.scroller.ios.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.scroller.sense-ui.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.scroller.wp.css" rel="stylesheet" type="text/css" />

    <link href="css/mobiscroll.animation.css" rel="stylesheet" type="text/css" />
    <link href="css/owl.carousel.css" rel="stylesheet">
    <link href="css/owl.theme.css" rel="stylesheet">
	<style>
		.ui-input-text.ui-shadow-inset.ui-corner-all.ui-btn-shadow.ui-body-j{
			
			visibility: hidden;
			border:none;
		}
		
		.ui-input-text.ui-shadow-inset.ui-corner-all.ui-btn-shadow.ui-body-j input{
			background:#f5f5f5;
		}
		#tableitems tr td{
}
		
	</style>
    <script type="text/javascript">
        $(function () {
            var curr = new Date().getFullYear();
            var opt = {
               
                'select': {
                    preset: 'select'
                }
            }


          
                var demo = $('#demo').val();

                if (!demo.match(/select/i)) {
                    $('.demo-test-' + demo).val('');
                }

                $('.demo-test-' + demo).scroller('destroy').scroller($.extend(opt[demo], {
                    theme: $('#theme').val(),
                    mode: $('#mode').val(),
                    lang: $('#language').val(),
                    display: $('#display').val(),
                    animate: $('#animation').val()
                }));
                
           
$('.demo').hide();
                $('.demo-' + demo).show();
          

           
            for(o=1 ;o<=100;o++)
            {
				$('#city0').append(new Option(o, o));
			}
			 for(o=1 ;o<=100;o++)
            {
				$('#city1').append(new Option(o, o));
			}
			
 
        });
  function call()
  {
       $(".owl-carousel").owlCarousel();


var owl = $("#owl-example");
        
    
	owl.trigger('owl.next');
  }
      function prev_image()
  {
       $(".owl-carousel").owlCarousel();


	var owl = $("#owl-example");
	owl.trigger('owl.prev');
  }    
  
  function sel_val(id,unit_price)
  {
  
   var store_id = localStorage.getItem('selected_storeid');
  var userid= localStorage.getItem('userid');
  var num=document.getElementById('city'+id).value * unit_price;
	var totalprice=(Math.round(num*100)/100).toFixed(2);
  document.getElementById('pen_val'+id).innerHTML = document.getElementById('city'+id).value;
  document.getElementById('tot'+id).innerHTML = '$ '+totalprice;
  var quantity=document.getElementById('city'+id).value;
  
  BUYDEMO.transaction(function(tx)
  {
  update_item_mobiscroll(store_id,id,userid,unit_price,quantity,totalprice);
  });
}
  
  
  function change_totals(itemid)
  {
  console.log("into change_totals");
   subtotal=0;
    tax=0;
    del_fee = 0;
    addnl_fee = 0;
    localStorage.setItem('selected_deliveryfee',del_fee);
    localStorage.setItem('selected_addionalfee',addnl_fee);
  var store_id = localStorage.getItem('selected_storeid');
  var userid= localStorage.getItem('userid');
  
  var selecteddeliveryfee=localStorage.getItem('selected_deliveryfee');
  BUYDEMO.transaction(function(tx)
  {
 // update_item_mobiscroll(store_id,id,userid,unit_price,quantity,totalprice);
  
  tx.executeSql('SELECT customer_items_details.* from customer_items inner join customer_items_details on customer_items.ID=customer_items_details.mainid where customer_items.storeid="'+store_id+'"', [], function (tx, results1)
			{
				var len = results1.rows.length;
			
			for(var k=0;k<len;k++)
	        	 {
	                 var result1 = results1.rows.item(k);
					 
					  var total =(result1.price * result1.quantity)*100/100;
						//alert('total'+total);
                                         console.log("1del_fee:"+del_fee+" addnl_fee:"+addnl_fee);       
					 if(result1.quantity==1){
                                            del_fee = del_fee + result1.deliveryfee;
                                         }
                                         if(result1.quantity>1){
                                             if(k==0){
                                                del_fee = del_fee + result1.deliveryfee;
                                             }
                                             addnl_fee =  addnl_fee + (result1.addn_fee * (result1.quantity-1));
                                         }
                                         localStorage.setItem('selected_deliveryfee',del_fee);
                                         localStorage.setItem('selected_addionalfee',addnl_fee);
                                         console.log("2del_fee:"+del_fee+" addnl_fee:"+addnl_fee);
					 tax =(((parseFloat(tax) + parseFloat(Math.round(result1.taxRate * total)/100))*100)/100).toFixed(2);
					 
					 var itemtax=(((Math.round(result1.taxRate * total)/100)*100)/100).toFixed(2);
					 var itemtotal= (((parseFloat(total) + parseFloat(itemtax))*100)/100).toFixed(2);
					 var subtotal_check = parseFloat(subtotal) + parseFloat(total);
					
					 subtotal =(Math.round(subtotal_check*100)/100).toFixed(2);
					 
					
					 document.getElementById('tot'+result1.itemid).innerHTML = '$ '+itemtotal;
					 document.getElementById('tax'+result1.itemid).innerHTML = '$ '+itemtax;
				}
                
					var finaltotal_check=parseFloat(subtotal) + parseFloat(tax);
                
                    var finaltotal=(Math.round(finaltotal_check*100)/100).toFixed(2);
                    
					document.getElementById('subtotal').innerHTML = subtotal;
					document.getElementById('tax').innerHTML = tax;
					document.getElementById('finaltotal').innerHTML = finaltotal;
					
					
					localStorage.setItem('shopping_subtotal',subtotal);
					localStorage.setItem('shopping_tax',tax);
					localStorage.setItem('shopping_finaltotal',finaltotal);
					
					
			});
  });
  }
  
  function del_item(itemid)
  {
       localStorage.setItem('selected_itemid1',itemid);
      navigator.notification.confirm(
                                     "Do you want to delete the item?",
                                     callBackFunction, // Specify a function to be called
                                     'Shopping',
                                     "OK,Cancel"
                                     );
  }
    
    function callBackFunction(r)
    {
	
	if (r==true)
	{
	 
	
	var storeid = localStorage.getItem('selected_storeid');
    var itemid = localStorage.getItem('selected_itemid1');
	  BUYDEMO.transaction(function(tx)
	  {
		tx.executeSql('SELECT customer_items_details.* from customer_items inner join customer_items_details on customer_items.ID=customer_items_details.mainid where customer_items.storeid="'+storeid+'"', [], function (tx, results1)
			{
			 var len = results1.rows.length;
			
			 if(len>1)
			 {
				tx.executeSql('DELETE FROM customer_items_details where itemid="'+itemid+'"');
				location.href="shopping.html";
			 }
			 else
			 {
				
				tx.executeSql('DELETE FROM customer_items_details where itemid="'+itemid+'"');
				tx.executeSql('DELETE FROM customer_items where storeid="'+storeid+'"');
				location.href="shopping.html";
			 }
			
			});
                          
                          return true;
	  });
      
      
	 
	}
	else
	{
	  return false;
	}
  
  }
  
    </script>
 </head>
 <body>
 	<div data-role="page" id="#buyNew-page" data-theme="j">

	    <div id="loginHeader" data-role="header" data-position="fixed"  data-tap-toggle="false" class="headerheight" data-theme="h">
			<a href="menu.html" rel="external" style="margin-top:-15px;" class="ui-btn-left"><div style="width:40px; height:44px;"><img class="imagesize" style="position:relative; top:17px;width:18px;height:18px;" src="images/arrow_left.png"/></div></a>	
			<h1>Shopping cart</h1>
			<a href="" rel="external" style="margin-top:-15px;" class="ui-btn-right"><div style="width:40px; height:44px;"><img class="imagesize" style="position:relative; top:17px;width:18px;height:18px;" src="images/arrow_right.png"/></div></a>	
			
		</div><!-- /header -->



		<div data-role="content">
			<div class="settings">
               
                <div data-role="fieldcontain">
                   

<input type="hidden" name="demo" id="demo" value="select"/>
                    

                 
                </div>
            </div>
           <div id="demo">
        <div class="container">
          <a href="#" rel="external" style="margin-top:-15px;" class="ui-btn-right">
					<div style="width:40px; height:44px;" id="previmage">
						
					</div>
				</a>
				<a href="#" rel="external" style="margin-top:-15px;" class="ui-btn-right">
					<div style="width:40px; height:44px;" id="nextimage">
						
					</div>
				</a>

          <div class="row" style="margin-left: 30px;margin-right:30px;margin-top: -55px;">
            <div class="span12">
            
			<p class="lab" style="font-size:16px;text-align:center" id="shpcart">Select Shopping Cart</p>
              <div id="owl-example" class="owl-carousel">
				
                
			</div>
               
            


            </div>
          </div>

        </div>
      </div>
          <br> 
			<div id="display_id"> </div>
			   
			 	
			<div class="clr"></div>
			<br/>
			<br/>
		

			
			<div data-role="popup" id="transitionExampl" class="ui-content" data-theme="d" style="border:1px solid #007aff">
  									 
			</div>

		</div><!-- /content -->

		<div data-role="footer" data-id="footer" data-position="fixed" data-theme="h">
			<div data-role="navbar">
				<ul>
					<li><a id="home" href="homepage.html"  rel="external" data-icon="home-blue" class="ui-state-persist"></a></li>
					<li><div id="total_count" style="background-color:#b31d1d;display:inline-block;margin-left:58%;margin-top:2%;color:#ffffff;text-align:center;z-index:2000;position:relative;font-size:12px;"></div><a id="basket" href="shopping.html" rel="external" data-icon="basket-orange" class="ui-state-persist bluetext" style="vertical-align: middle;margin-top:-22px"></a></li>
					<li><a id="list" href="menu.html" rel="external" data-icon="list-blue" class="ui-state-persist bluetext"></a></li>
					
				</ul>
			</div><!-- /navbar -->
		</div><!-- /footer -->
 

		
	</div><!-- /page -->
	<script src="js/function.js"></script>
	<script>
	var text;
	
function store_crousel_scroll()
{
text='';
document.getElementById('display_id').innerHTML = '';
BUYDEMO.transaction(function(tx) {
			
			var userid=localStorage.getItem('userid');
			
			 tx.executeSql('SELECT distinct storeid,storeimage from customer_items where customerid="'+userid+'"', [], function (tx, results)
			{
			 var len = results.rows.length;
			 if(len==0)
			 {
				 document.getElementById('shpcart').innerHTML = 'Shopping cart is empty!';
				
				 text = text +'<div class="divcolor" style="padding:10px 10px 10px 10px;height:20px;">';
					
					 text = text +'<a href="order.html" rel="external" style="background-color: #e5e5e5;float:right;position:relative;top:-15px;width:25%;min-width:80px;color:#007aff" data-role="button" >My Orders</a>';
				
				text = text +'</div>';
				 document.getElementById('display_id').innerHTML = text;
				 $("#display_id").trigger("create");
				 return;
			 }
			
			  var result = results.rows.item(0);
			
				for(var k=0 ;k<len;k++)
				{
					  var result1 = results.rows.item(k);
                                        
                                         var store_img_name = result1.storeimage.split('/')[1];
                                        var store_img = result1.storeimage.split('/')[2];
                                        
                                        
					text = text +'<div class="item">';
					if(k==0)
					{
					  text = text +'<img src="'+filePath+'/store/'+store_img_name+'/'+store_img+'" id="'+result1.storeid+'" width="80px" height="80px" alt="Touch" onclick="store_ordered_items(this.id)" style="border:1px solid #ff9000">';
					  localStorage.setItem('selected_storeid',result1.storeid);
					 }
					 else
					 {
					  text = text +'<img src="'+filePath+'/store/'+store_img_name+'/'+store_img+'" id="'+result1.storeid+'" width="80px" height="80px" alt="Touch" onclick="store_ordered_items(this.id)">';
					 }
					text = text +'</div>';
					
				}
				
				
						 document.getElementById('owl-example').innerHTML = text;
						
				if(len > 2)
				{
					$("#owl-example").owlCarousel({
                       pagination: false,
					    mouseDrag:true,
						touchDrag:true,
                   });
				   var text4;
				   text4='<img class="imagesize" onclick="call()" style="position: absolute;top: 125px;right:7px;background: white;border-radius: 9px;width:18px;height:18px;" src="images/arrow_right.png"/>';
				    document.getElementById('previmage').innerHTML = text4;
				   text4='<img class="imagesize" onclick="prev_image()" style="position: absolute;top: 125px;left:7px;background: white;border-radius: 9px;width:18px;height:18px;" src="images/arrow_left.png"/>';
				    document.getElementById('nextimage').innerHTML = text4;
				}
				else
				{
					
					 $("#owl-example").owlCarousel({
                       pagination: false,
					    mouseDrag:false,
						touchDrag:false,
						
						 
                   });
				   
			
			

				}
					
				   store_ordered_items(result.storeid);
			});
			
			});

}
var subtotal;
var tax;
var del_fee;
var addnl_fee;
function store_ordered_items(storeid)
{	
subtotal=0;
tax=0;
del_fee = 0;
addnl_fee = 0;
localStorage.setItem('selected_deliveryfee','0');
localStorage.setItem('selected_addionalfee','0');
var idarray=new Array();	

text='';
document.getElementById('display_id').innerHTML = '';

var previous_selectedid=localStorage.getItem('selected_storeid');

$('#'+previous_selectedid).removeClass('borderclass');

$('#'+previous_selectedid).css({'border' : '0px solid #ff9000'});	
localStorage.setItem('selected_storeid',storeid);
var selectedid=localStorage.getItem('selected_storeid');

$('#'+selectedid).css({'border' : '1px solid #ff9000'});

	BUYDEMO.transaction(function(tx) {
			
			 tx.executeSql('SELECT storename from customer_items where storeid="'+storeid+'"', [], function (tx, results)
			{
		
			var result = results.rows.item(0);
                           
                         //  var selecteddeliveryfee=localStorage.getItem('selected_deliveryfee');
                          
		text = text +'<div class="divcolor" style="padding:10px 10px 10px 10px;">';
			text = text +'<p style="text-align:center;font-size:14px;" class="orangetextnavbar">'+result.storename+'</p>';
			text = text +'<div >';	
					 text = text +'<a href="order.html" rel="external" style="background-color: #e5e5e5;float:right;position:relative;top:-51px;width:25%;min-width:80px;color:#007aff" data-role="button" >My Orders</a>';
				text = text +'</div>';
				
			text = text +'</div>';
			text = text +'<div class="clr"></div>';
			
			
			 tx.executeSql('SELECT customer_items_details.* from customer_items inner join customer_items_details on customer_items.ID=customer_items_details.mainid where customer_items.storeid="'+storeid+'"', [], function (tx, results1)
			{
			 var len = results1.rows.length;
			
			for(var k=0 ;k<len;k++)
	        	 {
	                 var result1 = results1.rows.item(k);
					 var total =(result1.price * result1.quantity)*100/100;
                                         if(result1.quantity==1){
                                            del_fee = result1.deliveryfee;
                                         }
                                         if(result1.quantity>1){
                                             if(k==0){
                                                del_fee = del_fee + result1.deliveryfee;
                                             }
                                             addnl_fee =  (result1.addn_fee * (result1.quantity-1));
                                         }
                                         localStorage.setItem('selected_deliveryfee',del_fee);
                                         localStorage.setItem('selected_addionalfee',addnl_fee);
                                         console.log("del_fee:"+del_fee+" addnl_fee:"+addnl_fee);
					 
					 tax =(((parseFloat(tax) + parseFloat(Math.round(result1.taxRate * total)/100))*100)/100).toFixed(2);
					 
					 var itemtax=(((Math.round(result1.taxRate * total)/100)*100)/100).toFixed(2);
					 var itemtotal= (((parseFloat(total) + parseFloat(itemtax))*100)/100).toFixed(2);
					 var subtotal_check = parseFloat(subtotal) + parseFloat(total);
                                         
                                         
					subtotal =(Math.round(subtotal_check*100)/100).toFixed(2);
					console.log("result1.itemimage:"+result1.itemimage);
                                        var store_img_name = result1.itemimage.split('/')[1];
                                        var store_img = result1.itemimage.split('/')[2];
                                        
                                                
                                                
			text = text +'<div class="divcolor" style="padding-bottom:10px;padding-left:10px;">';
			text = text +'<img style="position:relative;right:-17px;top:30px;float:right;" id="starImage" width="40px" height="40px" src="images/basket_del.png" onclick="del_item('+result1.itemid+')"/>';
			        			text = text +'<div style="float:left;margin-top:0px;">';
			        				text = text +'<img style="width:75px; height:75px;" src="'+filePath+'/store/'+store_img_name+'/'+store_img+'"/>';
			        			text = text +'</div>';
			        			text = text +'<div id="storeAddress" style="float:left;width:60%;padding-left:18px;margin-top:-40px;position:relative;">';
			        				text = text + '<div  style="float:left;padding-top:3px;padding-bottom:4px;width:100px;line-height: 25px;white-space:nowrap;">';
											text = text + '<span id="storeRestaurant'+result1.itemid+'" class="storeAddPopUpList" onclick="StoreAddressPopUp(this.id);" style="background-color:#f5f5f5;white-space:nowrap;">';
										
										text = text + '<span class="lab" style="position:relative;left:-5px;top:-5px;">'+result1.itemname+'</span>';
										text = text + '</span>';
										text = text + '</div>';
										text = text +'<div class="clr"></div>';
			        				text = text +'<label class="blacktext fontchangeShopping" style="font-weight:normal;position: relative;left:-6px;">';
										text = text +'<div style="position: relative;top: -6px;left:-7px;width:100%">';
											
											text = text +'<div style="width:100%;margin-bottom:5px;height:20px;">';
												text = text +'<div style="width:65px;float:left;">Unit Price:</div>';
												text = text +'<div style="float:left;" class="orangetextnavbar">$'+result1.price+'</div>';
											text = text +'</div>';
											text = text +'<div class="clr"></div>';
											text = text +'<div style="">';
												text = text +'<div style="height:22px;width:65px;float:left;">Qty:</div>';
												text = text +'<div id="pen_val'+result1.itemid+'"  style="height:22px;width:30px;float:left;" class="orangetextnavbar">'+result1.quantity+'</div>';
												text = text +'<div style="height:22px;width:24px;float:left;">';
													text = text +'<div data-role="fieldcontain" class="demo demo-select" style="position:relative;padding:0px;">';
            											text = text +'<select id="city'+result1.itemid+'"  class="demo-test-select" data-role="none" style="background-color:#f5f5f5;" onchange="sel_val('+result1.itemid+','+result1.price+');"></select>';
														text = text +'<img id="hell'+result1.itemid+'" style="width:22px;height:20px;" src="images/pencil.png" class="pencilPosition"/>'; 
          									  		text = text +'</div>';
          									  	text = text +'</div>';
											text = text +'</div>';
											
											
											text = text +'<div class="clr"></div>';
											text = text +'<div style="width:100%;margin-bottom:5px;height:20px;">';
												text = text +'<div style="float:left;width:65px;">Tax:</div>';
												text = text +'<div style="float:left;" class="orangetextnavbar" id="tax'+result1.itemid+'">$ '+itemtax+'</div>';
											text = text +'</div>';
											text = text +'<div class="clr"></div>';
											text = text +'<div style="width:100%;margin-bottom:5px;height:20px;">';
												text = text +'<div style="float:left;width:65px;">Total:</div>';
												text = text +'<div style="float:left;" class="orangetextnavbar" id="tot'+result1.itemid+'">$ '+itemtotal+'</div>';
											text = text +'</div>';
											
											
										text = text +'</div>';
									text = text +'</label>';
			        			text = text +'</div>';
								
			        			
								
			        			text = text +'<div class="clr"></div>';
			 text = text +'</div>';
			 text = text +'<br>';
			 idarray[k]=result1.itemid;
			 }
			 
			 text = text +'<hr/>';       			
			text = text +'<div style="width:100%;height:60px">';
				
				text = text +'<div style="margin-left:30%">';
				text = text +'<label class="blacktext  fontchangeShopping" style="font-weight:bold;white-space: nowrap;">';
					text = text +'<table >';
											
										
											var finaltotal_check=parseFloat(subtotal) + parseFloat(tax);
										
											var finaltotal=(Math.round(finaltotal_check*100)/100).toFixed(2);
											localStorage.setItem('shopping_storeid',storeid);
											localStorage.setItem('shopping_subtotal',subtotal);
											localStorage.setItem('shopping_tax',tax);
											localStorage.setItem('shopping_finaltotal',finaltotal);
											
                                                                                        
											text = text +'<tr>';
												text = text +'<td style="width:1px;"><b>Sub Total:</b></td>';
												text = text +'<td class="orangetextnavbar" id="subtotal">$ '+subtotal+'</td>';
											text = text +'</tr>';
											text = text +'<tr>';
												text = text +'<td><b>Tax:</b></td>';
												text = text +'<td class="orangetextnavbar" id="tax">$ '+tax+'</td>';
												
											text = text +'</tr>';
										
											text = text +'<tr>';
												text = text +'<td><b>Total:</b></td>';
												text = text +'<td class="orangetextnavbar" id="finaltotal">$ '+finaltotal+'</td>';
											text = text +'</tr>';
								text = text +'</table>';
								text = text +'</label>';
				text = text +'</div>';
				
				text = text +'</div>';
				
				text = text +'<div style="width:100%;margin-top:25px;">';
				
				text = text +'<div style="margin-left:35%;width:33.33%;position: relative;top: -3px;">';
				text = text +'<p style="text-align:center;"><a href="#" rel="external" class="fontchangeShopping" style="background-color:#007aff;color:white;min-width:68px;top:17px;-webkit-border-radius: 6px ;border-radius:6px " data-role="button" data-role="inline" onclick="getselectedstoredetails()">Checkout</a>';
				text = text +'</p></div>';
				
				
				text = text +'</div>';
			 
			
                           
						 document.getElementById('display_id').innerHTML = text;
						 $("#display_id").trigger("create");
						 mobiscroll();
						 get_img(idarray);
						 get_quantity(idarray);
			 });
			
						
			 });
			 });
}

		function getselectedstoredetails()
		{
			
			var storeid1 = localStorage.getItem('shopping_storeid');
			var subtotal1 = localStorage.getItem('shopping_subtotal');
			var tax1 = localStorage.getItem('shopping_tax');
			var finaltotal1 = localStorage.getItem('shopping_finaltotal');
			var selecteddeliveryfee1=localStorage.getItem('selected_deliveryfee');
                        var selectedaddionalfee = localStorage.getItem('selected_addionalfee');
                        console.log("selecteddeliveryfee1:"+selecteddeliveryfee1+" selectedaddionalfee:"+selectedaddionalfee);
			localStorage.setItem('checkout_storeid',storeid1);
			localStorage.setItem('checkout_subtotal',subtotal1);
			localStorage.setItem('checkout_tax',tax1);
                        localStorage.setItem('checkout_deliveryfee',selecteddeliveryfee1);
                        localStorage.setItem('checkout_additionalfee',selectedaddionalfee);
			localStorage.setItem('checkout_finaltotal',finaltotal1);
			location.href="purchase.html";
		}
	
		function mobiscroll()
		{
		
			$(function () 
			{
																									
            var opt = {
               
					'select': {
                    preset: 'select'
							 }
					  }


          
            var demo = $('#demo').val();
         
                if (!demo.match(/select/i))
				{
                    $('.demo-test-' + demo).val('');
                }

                $('.demo-test-' + demo).scroller('destroy').scroller($.extend(opt[demo], {
                   
                }));
                
      
				$('.demo').hide();
                $('.demo-' + demo).show();
          
		
		});
		
		}
		
		function get_img(id)
		{
		
		var choosenpic="url(images/pencil.png) no-repeat";
		 for(var i=0;i<id.length;i++)
		  {
			
		$('#city'+id[i]+'_dummy').css("background",choosenpic);
		$('#city'+id[i]+'_dummy').css({'background-size' : '30px 30px'});
		$('#city'+id[i]+'_dummy').css({'width' : '30px'});
		$('#city'+id[i]+'_dummy').css({'height' : '30px'});
		$('#city'+id[i]+'_dummy').css({'background-color' : '#f5f5f5'});
	
		$('#city'+id[i]+'_dummy').css({'border' : 'none'});
		$('#city'+id[i]+'_dummy').css({'outline' : '0 none !important;'});
		$('#city'+id[i]+'_dummy').css({'-webkit-appearance' : 'none'}); 
		$('#city'+id[i]+'_dummy').css({'box-shadow' : 'none !important'});
		
		 }
		}
		
		function get_quantity(id)
		{
			for(var i=0;i<id.length;i++)
			{
				for(var o=1;o<=100;o++)
				{
				$('#city'+id[i]).append(new Option(o, o));
				}
			}
		}
		
		function change_quantity()
		{
		var count=0;
		var userid=localStorage.getItem('userid');
       
		BUYDEMO.transaction(function(tx) {
		tx.executeSql('SELECT * FROM customer_items_details inner join customer_items on customer_items.ID=customer_items_details.mainid where customer_items.customerid="'+userid+'"', [], function (tx, results) {
		var len=results.rows.length;
            
			for(var j=0;j<len;j++)
			{
			 var resultres = results.rows.item(j);
		
			 count=count+resultres.quantity;
			
			
			
			}
                    
			if(count<10)
			{
					$('#total_count').css({'-moz-border-radius' : '50%'});
					$('#total_count').css({'-webkit-border-radius' : '50%'});
					$('#total_count').css({'border-radius' : '50%'});
					$('#total_count').css({'width' : '16px'});
					$('#total_count').css({'height' : '16px'});
			}
			else if(count>9 && count<100)
			{
					$('#total_count').css({'-moz-border-radius' : '50%'});
					$('#total_count').css({'-webkit-border-radius' : '50%'});
					$('#total_count').css({'border-radius' : '50%'});
					$('#total_count').css({'width' : '20px'});
					$('#total_count').css({'height' : '16px'});
			}
			else if(count>99 && count<1000)
			{
					$('#total_count').css({'-moz-border-radius' : '50%'});
					$('#total_count').css({'-webkit-border-radius' : '50%'});
					$('#total_count').css({'border-radius' : '50%'});
					$('#total_count').css({'width' : '25px'});
					$('#total_count').css({'height' : '16px'});
			}
			else
			{
					$('#total_count').css({'-moz-border-radius' : '50%'});
					$('#total_count').css({'-webkit-border-radius' : '50%'});
					$('#total_count').css({'border-radius' : '50%'});
					$('#total_count').css({'width' : '30px'});
					$('#total_count').css({'height' : '16px'});
			}
			
			 document.getElementById('total_count').innerHTML =count;
		 });
		
		});
		}
		
		function StoreAddressPopUp(t){
						

					   if ($('#'+t).innerWidth()< $('#'+t)[0].scrollWidth) {
   							document.getElementById('transitionExampl').innerHTML = document.getElementById(t).innerHTML;
							$( '#transitionExampl' ).popup( "open" );
							}
						 
				}
	</script>
 </body>
</html>

